Code based on Okasaki's Purely Functional Data Structures.